# Main Configuration File for HandPoseReconstruction Training
# @package _global_

# defaults list
defaults:
  - datamodule: handencoder_dm_dex_debug
  - model: flow_matching_hand_dit
  - backbone: ptv3_sparse
  - hand_encoder: transformer_bias
  - dit: graph_dit_default
  - loss: flow_matching
  - optimizer: adamw
  - trainer: default
  - logger: tensorboard   # tensorboard
  - callbacks: default
  - experiments: null # Changed from experiment to experiments to match folder structure
  - _self_

# Experiment settings
experiment_name: exp_grasp16_1120
seed: 42

# Advanced Training Controls
auto_scale_batch_size: false # Set to true to find the largest batch size
auto_lr_find: false          # Set to true to find the optimal learning rate
auto_resume: false           # Set to true to resume from the last checkpoint in the experiment folder

# Common hyperparameters (可被其他配置引用)
batch_size: 128
rot_type: r6d  # 'quat' | 'r6d' | 'euler' | 'axis'
hand_anchor: palm_center  # 'base' | 'palm_center' | 'mjcf'
# PyTorch 2.x 编译（torch.compile），已改为仅编译 DiT 部分以避免 Inductor 错误
compile: true

# Paths
paths:
  # Use the original working directory (project root), not Hydra's run dir
  root_dir: ${hydra:runtime.cwd}
  data_dir: ${paths.root_dir}/data
  output_dir: ${paths.root_dir}/outputs/${experiment_name}/${now:%Y-%m-%d_%H-%M-%S}
  assets_dir: ${paths.root_dir}/assets

# Hydra settings
hydra:
  run:
    dir: ${paths.output_dir}
  sweep:
    dir: ${paths.root_dir}/outputs/sweeps/${now:%Y-%m-%d_%H-%M-%S}
    subdir: ${hydra.job.num}
  job:
    chdir: true  # Change working directory to output directory
    env_set:
      PYTHONPATH: ${hydra:runtime.cwd}/src:${oc.env:PYTHONPATH,}
