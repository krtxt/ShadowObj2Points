# Model Configuration for HandPointsReconstruction (Hydra instantiation)
_target_: src.models.hand_points_reconstruction.HandPointsReconstruction

model_cfg:
  # 是否使用归一化后的关键点作为编码器输入
  use_norm_xyz: false

  # Hand Encoder配置（可切换 egnn_lite / transformer_bias）
  hand_encoder:
    type: egnn_lite        # 'egnn_lite' | 'transformer_bias'
    num_fingers: 6
    num_joint_types: 11
    num_edge_types: 4
    d_model: 128
    n_layers: 3
    d_edge: 64
    d_struct: 8
    num_frequencies: 10
    n_heads_pma: 4
    out_dim: 512          # hand token 维度
    dropout: 0.1
    # 仅 Transformer Bias 变体使用
    n_heads: 4
    ffn_ratio: 2

  # Transformer Encoder配置
  transformer:
    embed_dim: 512
    num_heads: 8
    num_layers: 6
    ffn_dim: 1024
    dropout: 0.1
    use_cls_token: true

  # Hand Decoder配置（约束刚体组内距离）
  hand_decoder:
    hidden_dim: 256
    dropout: 0.1
    finger_emb_dim: 16
    joint_emb_dim: 16

# 复用全局 loss / optimizer 配置
loss_cfg: ${loss}
optimizer_cfg: ${optimizer}
