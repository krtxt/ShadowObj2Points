# Model Configuration for HandPoseReconstruction (Hydra instantiation)
_target_: src.models.hand_pose_reconstruction.HandPoseReconstruction

# Pass the sub-configs as a single model_cfg dictionary, to match __init__ signature
model_cfg:
  # 是否使用归一化后的关键点作为编码器输入
  use_norm_xyz: false
  # Hand Encoder配置
  hand_encoder:
    type: egnn_lite  # 'egnn_lite' | 'transformer_bias'
    num_fingers: 6
    num_joint_types: 11
    num_edge_types: 4
    d_model: 128
    n_layers: 3
    d_edge: 64
    d_struct: 8
    num_frequencies: 10
    n_heads_pma: 4
    out_dim: 512  # hand token维度
    dropout: 0.1
    # 仅用于transformer_bias
    n_heads: 4
    ffn_ratio: 2

  # Transformer Encoder配置
  transformer:
    embed_dim: 512
    num_heads: 8
    num_layers: 6  # M=4–8
    ffn_dim: 1024
    dropout: 0.1
    use_cls_token: true

  # Pose Predictor配置
  pose_predictor:
    num_joints: 24
    hidden_dim: 128
    dropout: 0.1
    predict_translation: false
    predict_rotation: false
    # 关节限位（可选，如果不提供则使用默认的[-pi, pi]）
    joint_lower: null  # 例如: [-1.57, -1.57, ..., -1.57]
    joint_upper: null  # 例如: [1.57, 1.57, ..., 1.57]

# Wire other configs directly
loss_cfg: ${loss}
optimizer_cfg: ${optimizer}
